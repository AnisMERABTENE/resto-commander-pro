<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Client Test Socket.io</title>
</head>
<body>
  <h1>üëã Client Socket.io - Test Commandes</h1>
  <p id="status">Connexion...</p>

  <p>
    R√¥le :
    <select id="role-select">
      <option value="CUISINIER">Cuisinier</option>
      <option value="BARMAN">Barman</option>
      <option value="SERVEUR">Serveur</option>
      <option value="PATRON">Patron</option>
    </select>
    <button onclick="join()">Rejoindre</button>
  </p>

  <pre id="log"></pre>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    const socket = io('http://localhost:4000')

    socket.on('connect', () => {
      document.getElementById('status').textContent = '‚úÖ Connect√©'
      log('üü¢ Connect√© avec id : ' + socket.id)
    })

    function join() {
      const role = document.getElementById('role-select').value
      socket.emit('join', role)
      log('üë§ Rejoint le r√¥le : ' + role)
    }

    // üîî Commande envoy√©e au CUISINIER ou BARMAN
    socket.on('commande:new', (data) => {
      log('üõéÔ∏è commande:new :\n' + JSON.stringify(data, null, 2))
    })

    // ‚úÖ Commande re√ßue ‚Üí affich√©e chez le SERVEUR
    socket.on('commande:re√ßue', (data) => {
      log('‚úÖ commande:re√ßue :\n' + JSON.stringify(data, null, 2))
    })

    // ‚úÖ Commande pr√™te ‚Üí affich√©e chez le SERVEUR
    socket.on('commande:prete', (data) => {
      log('üçΩÔ∏è commande:prete :\n' + JSON.stringify(data, null, 2))
    })
    socket.on('stock:low', (data) => {
      log('‚ö†Ô∏è stock:low :\n' + JSON.stringify(data, null, 2))
   })

    function log(msg) {
      const logEl = document.getElementById('log')
      logEl.textContent += msg + '\n\n'
    }
  </script>
</body>
</html>
